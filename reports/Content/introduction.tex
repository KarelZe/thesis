\section{Introduction}\label{sec:introduction}

Every option trade has a buyer and seller side. For a plethora of problems in option research, itâ€™s also crucial to determine the party that initiated the transaction. Common applications include the study of option demand \autocite[][4261]{garleanuDemandBasedOptionPricing2009}, of informational content in option trading \autocites[][631]{huDoesOptionTrading2014}[][882]{panInformationOptionVolume2006}[][1079]{caoInformationalContentOption2005}, of order flow \autocite[][684]{muravyevOrderFlowExpected2016}, or of trading costs \autocite[][4980]{muravyevOptionsTradingCosts2020}. 

Despite the clear importance for empirical research, the true initiator of the trade is frequently missing in option data sets and must be inferred using trade classification rules \autocite[][453]{easleyOptionVolumeStock1998}. In consequence, the correctness of empirical studies depends on the algorithm's ability to accurately identify the trade initiator.

Among the most prevailing variants to sign trades are the tick test \autocite[][240]{hasbrouckTradesQuotesInventories1988}, quote rule \autocite[][41]{harrisDayEndTransactionPrice1989}, and hybrids thereof such as the \gls{LR} algorithm \autocite[][745]{leeInferringTradeDirection1991}, the \gls{EMO} algorithm \autocite[][536]{ellisAccuracyTradeClassification2000}, and the \gls{CLNV} method \autocite[][3812]{chakrabartyTradeClassificationAlgorithms2007}, that infer the trade initiator from adjacent prices and quotes. These heuristics have initially been proposed and tested in the stock market.

For option markets, the works of \textcites[][11--13]{grauerOptionTradeClassification2022}[][887--891]{savickasInferringDirectionOption2003} raise concerns about the transferability of standard trade signing rules due to deteriorating classification accuracies and systematic misclassifications. The latter is critical, as non-random misclassifications ultimately bias the dependent research \autocites[][260]{odders-whiteOccurrenceConsequencesInaccurate2000}[][157]{theissenTestAccuracyLee2001}.

Recent work of \textcite[][13--16]{grauerOptionTradeClassification2022} made significant progress in classification accuracy by proposing explicit overrides for order types and by combining multiple heuristics, thereby advancing the state-of-the-art performance in option trade classification. By this means, their approach enforces a more sophisticated decision boundary eventually leading to a more accurate classification. The fundamental constraint is, that overrides apply only to subsets of trades. Beyond heuristics, it remains open, if classifiers \emph{learned} on trade data can improve upon \emph{static} classification rules in terms of performance and robustness.

Our work fills this gap by focusing on machine learning methods to infer the trade initiator in the option market. Approaching trade classification with machine learning is a logical choice, given its capability to handle high-dimensional trade data and learn complex decision boundaries. This raises the question, \emph{can an alternative machine learning-based classifier improve upon the accuracy of state-of-the-art approaches for option trade classification?}

To answer this question, we model trade classification through machine learning. We consider the supervised case, where fully-labeled trade data is available, as well as the semi-supervised setting, where trades are partially labeled. Our work makes the following contributions:
\begin{enumerate}[label=(\roman*),noitemsep]
    \item We employ state-of-the-art supervised algorithms i.~e., gradient boosting and Transformer networks to the problem of trade classification and benchmark these approaches against rule-based methods. Our approaches outperform all rule-based approaches on \gls{ISE} and \gls{CBOE} data with comparable data requirements. Our smallest and medium-sized Transformers outperform state-of-the-art rules from \textcite[][13--15]{grauerOptionTradeClassification2022} by \SI{3.73}{\percent} to \SI{4.97}{\percent} in accuracy on \gls{ISE} and \SI{5.44}{\percent} to \SI{5.64}{\percent} on \gls{CBOE}. The largest Transformer with additional dependencies on option data classifies up to \SI{74.28}{\percent} correctly, which improves the benchmark by +\SI{7.76}{\percent}. For gradient boosting improvements in accuracy range between \SI{3.62}{\percent} and \SI{4.73}{\percent} on \gls{ISE}, and between \SI{5.26}{\percent} and \SI{5.43}{\percent} on \gls{CBOE}, when trained solely on trade data. Moreover, we apply our classifiers to the problem of effective spread estimation. On \gls{CBOE} data, our models approximate the true effective spread of \SI{2.50}{\percent} best versus an estimated spread of \SI{5.70}{\percent}. On \gls{ISE} they are among the best-performing solutions.
    \item For the semi-supervised case, we extend the classifiers to learn on both labeled and unlabeled instances through pre-training and self-training procedures. We analyze the effect on classification accuracy and observe that pre-training of Transformers further alleviates classification performance on \gls{ISE} trades with accuracies up to \SI{74.55}{\percent} or +\SI{6.94}{\percent}.
    \item Through a game-theoretic approach, our work is the first to consistently attribute the performance of rule-based and machine learning-based classifiers to individual features. We discover that both paradigms share common features, but machine learning-based classifiers attain higher performance gains and effectively exploit the data. By probing and visualizing the attention mechanism in the Transformer, we can strengthen the connection to rule-based classification and reveal that \emph{learned} rules mimic classical rules.
\end{enumerate}

The remainder of this thesis is organized as follows. \cref{sec:related-work} reviews publications on trade classification in option markets or using machine learning, thereby underpinning our research framework. \cref{sec:rule-based-approaches} introduces methods for rule-based trade classification. \cref{sec:supervised-approaches} introduces and discusses supervised methods for trade classification. Then, \cref{sec:semi-supervised-approaches} extends the previously selected algorithms for the semi-supervised case. We test the models in \cref{sec:empirical-study} in an empirical setting and report results in \cref{sec:results}. In \cref{sec:application}, we apply our classifiers to the problem of effective spread estimation. Finally, \cref{sec:conclusion-outlook} concludes.
