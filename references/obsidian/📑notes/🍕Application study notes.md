**Intuitive Explanation from Hagströmer**
Accurate liquidity measurement is important for liquidity timing and order routing. One of the most prevalent measures is the effective spread, defined as the percentage difference between the transaction price and the bid-ask spread midpoint. For example, if the quotes for a stock are $10.00 to sell and $10.01 to buy, the effective spread of a buy trade at $10.01 is half a cent (about 5 basis points).
![[midpoint-spread.png]]

To see the logic of the effective spread, consider the market maker who sells to the incoming trader. The market maker provides the service of immediate execution, and in return earns a premium relative the fundamental value of the shares. The effective spread captures that premium, using the spread midpoint as a proxy for the fundamental value.

**Problem of effective spreads and why it is a problem:**
To see this, assume that the fundamental value of the stock in the example above is 10 dollars and 0.25 cents. The effective spread is then asymmetric; 0.25 cents for trades on the bid side and 0.75 cents (three times higher) on the ask side. If traders care about transaction costs, the relatively wide ask-side spread deters buyers, whereas the tight bid-side spread may attract sellers. There are then more traders submitting market orders at the bid side, and the true effective spread is, on average, smaller than the average midpoint effective spread (which is 0.5 cents).
![[asymmetric-spread.png]]

“The midpoint effective spread bias can be illustrated by a simple example. Consider a stock with a fundamental value of USD 25.0025 that has liquidity supplied at the nearest prices where trading is allowed, USD 25.00 and USD 25.01. The effective spread is then asymmetric. For trades executed at the bid price it is half a cent (2 × 0.25 cents), whereas for ask-side trades it is three times higher, 1.50 cents (2 × 0.75 cents). If investors factor in the cost asymmetry in their trading decisions, market orders are in this example more likely to arrive on the bid side than on the ask side. The effective spread is then, on average, smaller than the midpoint effective spread (which is one cent).” ([[@hagstromerBiasEffectiveBidask2021]], p. 315)

- **Why it is important:** 
- capture true spread faced by traders.
- “When trades are executed inside the posted bid-ask spread, the posted spread is no longer an accurate measure of transactions costs faced by investors.” (Petersen and Fialkowski, 1994, p. 209)
- Petersen,M., and D. Fialkowski. "Postedversus Effective Spreads: Good Prices or Bad Quotes?" Journalof FinancialEconomics,35 (1994), 269-292. [[@petersenPostedEffectiveSpreads1994]]
- “The effective bid-ask spread is one of the most prevalent measures of market illiquidity, used in diverse applications ranging from the evaluation of market structure changes (e.g., Hendershott et al., 2011) and transaction cost measures (e.g., Hasbrouck, 2009), to asset pricing (e.g., Korajczyk and Sadka, 2008), corporate finance (e.g., Fang et al., 2009), and macroeconomics (e.g., Næs et al., 2011).” ([[@hagstromerBiasEffectiveBidask2021]], p. 314)
- **quoted spread vs. effective spread:** “In the simple security markets described in standard financial models e.g., Roll (1984), trades take **place at the prices** posted by the specialist. Since market orders purchase stock at the ask and sell stock at the bid, these orders pay the spread between the bid and the ask. The spread arises due to the costs of  and because liquidity providers face some traders who know more about the future value of the security than they Treynor (1971) and Glosten and Milgrom (1985). In U.S. equity markets, however, trades inside the spread are a frequent occurrence.” Market orders may transact inside the spread if the specialist does not always display the best public limit orders. Market orders may also trade at prices better than the posted quotes when they are matched with other market orders. Once trades occur inside the posted spread, the posted spread overstates an investor’s expected trading costs. Since investors can expect to buy at prices lower than the ask and sell at prices higher than the bid, the effective spread is the relevant measure of trading costs.” (Petersen and Fialkowski, 1994, p. 210)

- **Difference between quoted spread and effective spread:**
Found at: https://berkeley-defi.github.io/assets/material/Bid-Ask-Spreads-Measuring-Trade-Execution-Costs-in-Financial-Markets-2010.pdf
- The Quoted Spread The simplest measure of trading cost is the quoted spread (QS), which is defined as the difference between the bid and ask prices. The quoted spread measures the cost of completing a round trip (buy and sell), if trades are executed at the quoted prices. Execution costs for a single trade are often measured as half the spread, described on a percentage basis by equation (1): Quoted half-spread = QSit = 100 * (Askit – Bidit) / (2 times Mit) (1) where Ait and Bit are the posted ask price and bid price for security i at time t, respectively, and Mit, the quote midpoint or mean of Ait and Bit, is a proxy for the true underlying security value. The Effective Spread In many dealer markets, including those that trade fixed-income securities and foreign exchange, the quoted prices are simply a starting point for negotiations between customers and dealers, and transactions frequently occur at prices other than the quotes. Also, in some markets, including those relying on trading floors, there may be latent liquidity not reflected in the quotes. On the New York Stock Exchange (NYSE), for example, market orders may execute at prices within the quotes when the specialist (the NYSE’s designated dealer) or a floor broker elects to improve on the quote (see ). Many electronic exchanges allow traders to 5 hide some or all of the order size, implying that limit orders offering more attractive prices than the quotes may exist on the book (see 9). 
- Further, quoted prices pertain only to the quoted depth; large orders might exhaust the depth at the quote and “walk up the book”, executing against limit orders with less attractive prices and leading to a weighted-average trade price outside the quotes. When trades occur either within or outside the quotes, a better measure of trading costs is the percentage effective half spread, which is based on the actual trade price, and is computed on a percentage basis as described in equation (2): Effective half-spread = ESit = 100 * Dit * (Pit – Vit) / Vit (2) where Pit is the transaction price for security i at time t, Dit is an indicator variable that equals one for customer buy orders and negative one for customer sell orders, and Vit is an observable proxy for the true underlying value of security i at time t. The effective spread is based on the deviation between the execution price and the true underlying value of the security, and can be viewed as an estimate of the execution cost actually paid by the trader and the gross revenue earned by the liquidity provider.

- **What it is:** “The effective spread is the difference between the transaction price and the “true value” ([[@goettlerEquilibriumDynamicLimit2005]]). As Bessembinder and Venkataraman (2010) explain, in empirical analyses the effective spread is computed using “an observable proxy for the true underlying value of (the) security.” Researchers often use the bid-ask midpoint as a proxy for the value and thus measure the effective half-spread as the difference between the transaction price and the bid-ask midpoint, adjusted for trade direction. If the timing of executions is uncorrelated with the errors in using the midpoint as a proxy, using it will result in unbiased estimates of average trading costs even though the errors resulting from the use of the proxy in place of the “true value” or fair value result in noisy estimates of the effective spread for individual trades. But if the timing of executions is correlated with the errors in using the midpoint as a proxy then the estimates of trading costs will be biased. This happens, for example, if executions are more likely to occur after some traders have entered aggressive limit orders, or if some traders are slow to cancel stale limit orders.” ([[@muravyevOptionsTradingCosts2020]], p. 4975)

- **Limitations of the effective spread for options:** “Because executions at the ask (bid) price tend to occur when the estimates of options’ fair values are close to the ask (bid) price, the difference between the option value and the bid-ask midpoint is large conditional on a trade, and correlated with the trade direction. For example, an execution at the ask price might occur when the estimate of fair value is two cents below the ask price but the quote midpoint is five cents below the ask price. In this case the effective half-spread based on the fair value is only two cents but the conventional estimate based on the midpoint would be five cents.” (Muravyev and Pearson, 2020, p. 4975)
- **Limitations:** “Lee (1993) and Blume and Goldstein (1992b) compare transaction prices to the midpoint of the quoted spread. This method accurately estimates the effective spread only when market orders are matched solely with limit orders (the specialist or a public limit order). If market orders are matched with each other, then this method will overestimate the spread actually paid. Some of the market orders will pay significantly less than the posted spread.” ([[@petersenPostedEffectiveSpreads1994]], p. 210)

- **Why it is important:** “While this may seem a relatively modest improvement, a more compelling case for the proposed algorithm arises in specific applications. An important ap? plication of trade classification algorithms is the computation of effective bid-ask spreads, which measure the difference between actual trade prices and quotes (see Petersen and Fialkowski (1994)). When trades routinely transact between the quotes, this measure will give a smaller, and more accurate, estimate of trans? actions costs than do posted bid-ask spreads.” ([[@ellisAccuracyTradeClassification2000]]p. 540)

- “Conceptually, the effective bid-ask spread measures the cost of immediate execution, defined as twice the difference between the transaction price and the fundamental value. Whereas transaction prices are widely disseminated in financial markets, the fundamental value is unobservable. Empirical implementations of the effective bidask spread instead rely on the average of the best bid and ask prices, known as the “midpoint,” as its benchmark (Blume and Goldstein, 1992 (unpublished?); [[@leeMarketIntegrationPrice1993]]). The use of the midpoint as a proxy for the fundamental value goes back to Demsetz (1968).” ([[@hagstromerBiasEffectiveBidask2021]], p. 314)

- “One measure of this split is the transaction costs paid by market order submitters.” (Goettler et al., 2005, p. 2172)
- “We define the true transaction cost for a market order as the difference between the average transaction price and the true value of the asset.” (Goettler et al., 2005, p. 2172)

- “In the first set of tests, the liquidity premium for each trade is computed as the absolute difference between the actual trade price and the "midspread" (average of bid and ask prices) of the prevailing quote at the time of the trade. Assuming that, on average, the specialist's spread is set symmetrically around the equilibrium price, the liquidity premium provides an estimate of the effective "half-spread" for each trade."” ([[@leeMarketIntegrationPrice1993]]1018)

- **Description in Savickas:** To assess the applicability of trade classification rules to estimating the effective bid-ask spread in the options market, we compute the dollar spread as follows: $S_i=2\left(P_{t, i}-P_{m, i}\right) I$, where $S_i$ is the effective spread implied by the price of transaction $i ; P_{m, i}$ is the bid-ask spread midpoint using quotes outstanding at the time of transaction $i ; P_{t, i}$ is the option price at transaction $i$; and $I=1$ if trans'action $i$ is a buy and $I=-1$ if it is a sell. The percentage spread is computed as $P S_i=S_i / P_{m, i}$. Dollar and percentage spreads estimated by each of the classifiication techniques are averaged over the entire sample and compared to the actual iaverage effective spreads. The results are in Table 5. All four methods perform poorly at estimating effective bid-ask spread for options. ([[@savickasInferringDirectionOption2003]], p. 7)

- “The effective spread is calculated as Effective spread = 2 * I ([transaction price - midpoint price]), where / is an indicator variable that equals one for buy trades and negative one for sell trades, and the midpoint is the average of the bid and ask prices. Obviously, correct classification of buy and sell trades is crucial in calculations of the effective spread.14” ([[@ellisAccuracyTradeClassification2000]], p. 541)

- **Motivation in Theissen:** “Usually, an estimate of the effective bid-ask spread is obtained by relating the transaction price to the midpoint of the bid and ask quote, i.e. 200 tt e t pm sm − = (1) where pt is the transaction price and mt is the midpoint of the bid and ask quote at the moment when the transaction occurs. We multiply the measure by 200 and divide it by the midquote to obtain an estimate of the percentage spread (rather than the half-spread). This measure im” (Theissen, 2000, p. 11)
- “12 plicitly assumes that transactions at prices above [below] the midpoint are buyer-initiated [seller-initiated]. Put differently, the assumption is made that the quote test classifies all transactions correctly. If this assumption is not true, some transactions at prices below the midpoint are buys and some transactions at prices above the midpoint are sells. This will result in a downward bias of the estimated effective spread irrespective of whether there is any systematic pattern in the classification accuracy. If the true trade classification is known and denoted true I (with true I equal to 1 [-1] for a buyer-initiated [seller-initiated] transaction), the effective spread can be estimated as () 200 true t t e t Ipm sm − = (2) Lightfood et al. (1999) compare this estimate to the traditional spread estimate and find that the bias of the traditional measure is economically significant, amounting to up to 30%.” (Theissen, 2000, p. 12)
- **Statistical test:** “We repeated this analysis with our dataset from the Frankfurt Stock Exchange. The results are presented in columns 2 and 3 of Table 5. The bias is even more dramatic. The traditional spread estimate is, on average, about twice as large as the “true” spread.8 A Wilcoxon test rejects the null hypothesis of equal medians (p < 0.01). Despite the large differences, the correlation between the two spread estimates is very high (ρ= 0.96). The magnitude of the relative bias (i.e., the traditional spread estimate divided by the “true” spread) is strongly negatively related to the classification accuracy. The correlation is –0.84.” ([[@theissenTestAccuracyLee2000]] p. 12)
- “. **effective spread and relative effective spread** The trading cost measures considered here are the effective spread and the relative effective spread. The effective spread, which represents the round trip execution costs, less commissions, is calculated as: Effective spread ¼ 2 D ðPrice midpointÞ where D is the trade direction, þ1 for a buy, and 1 for a sell. Using only TAQ data, one must infer D: The midpoint must also be estimated because the TAQ data report the trade time, not the order submission time. As noted in Bacidore et al. (1999), execution quality is most appropriately measured setting the benchmark quote to that prevailing at order submission time. The relative effective spread is calculated as Relative effective spread ¼ Effective spread=price: Next, we demonstrate the possible limitations of trade and quote data in estimating trading costs by providing two specific examples—price improvement in minimum variation markets and quote changes prior to trade execution.” ([[@petersonEvaluationBiasesExecution2003]] p. 261)

- “Although it is clear that the classification errors associated with LR's algorithm and the tick test are significant, it is important to consider whether em? pirical research employing these methods might be biased by the errors. Since these methods are most commonly applied in estimating effective bid-ask spreads and signed volume, the possibility that imperfectly inferring trade direction might bias empirical inferences is tested by comparing true effective spreads to effective spreads estimated using LR's method and the tick test, and by comparing true signed volume to signed volume estimated using the two methods of inferring trade direction. The sample of 144 firms is first divided into dollar volume deciles, and mean effective percentage bid-ask spreads are estimated for each decile. Effective spreads are measured as twice the percentage half-spread for each observation, (3) ESl7 = 2(l00)(Dit)(Sit-Mit)/Mih where Du = 1 for purchases and ? 1 for sales, Sit is the trade price for stock i at time r, and Mit is the midpoint of the quoted spread. Du is measured in three ways: using the true order direction from the TORQ order file, using LR's algorithm, and using the tick test.13 The true effective spreads, estimated effective spreads, and quoted spreads are presented in (see screenshot below).” (([[@finucaneDirectTestMethods2000]], p. 569)
- ${ }^{13}$ Since LR's algorithm always assigns a direction of one to trades above the midpoint and $-1$ to trades below the midpoint, and since the effective spread for trades at the midpoint is equal to zero, an equivalent expression for the effective spread under LR's method is: $\mathrm{ES}_{i t}=2(100)\left|S_{i t}-M_{i t}\right| / M_{i t}$. ([[@finucaneDirectTestMethods2000]]569)

![[eff-spread-finucane.png]]

![[effective-spead-options.png]]
(copied from [[@savickasInferringDirectionOption2003]]897)

**Calculate differences:** Panel A indicates improvements can be made when using different quote lags and/ or trade direction algorithms. Staying with the $1 / 8$ ths pricing regime, we see the EMO algorithm with no lag for benchmark quote assignment reduces biases to $6.6 \%$ $(=12.78 / 11.99-1)$. For most categories, the EMO algorithm outperforms the LR algorithm and the Lee/Ready estimator. (For each row in the table we have bolded the cell with the least bias.) (found in [[@petersonEvaluationBiasesExecution2003]] 278)

**Why we use the midpoint:** “In the presence of trading frictions, the transaction price P typically differs from the fundamental value X. The effective spread quantifies the difference, and may be viewed as a premium paid for the service of immediacy in securities trading. The nominal effective spread is defined as S = 2D(P − X ), (1) where D is a direction of trade indicator taking the value +1 for buyer-initiated trades, and -1 for seller-initiated trades. The multiplication by two is for consistency with the quoted bid-ask spread (defined below for a hypothetical roundtrip trade). For ease of exposition, I suppress stock and time subscripts for all variables in this section. Because the fundamental value at the time of transaction is unobservable, the effective spread is estimated relative to a proxy, which I denote ̃ X. An effective spread estimator can then be defined as ̃ S = 2D(P − ̃ X). (2) Various fundamental value proxies are distinguished with the superscript v, ̃ Xv. For example, I denote the midpoint ̃ Xmid. Similarly, an effective spread estimator utilizing the fundamental value estimator v is denoted ̃ Sv. The midpoint effective spread, as defined by Blume and Goldstein (1992) and Lee (1993) as well as in the RegNMS Rule 605, is thus denoted ̃ Smid . An effective spread estimator is unbiased if the expected difference between the expressions in (1) and (2) is zero. The expected difference is E( ̃ S − S) = 2E(D(X − ̃ X)), (3) implying that the effective spread estimator is unbiased if and only if D and (X − ̃ X ) are uncorrelated. This can be expected either if investors are unable to assess the sign of (X − ̃ X ), or if the liquidity demand elasticity is zero. Consider again the example in the introduction. Whe” ([[@hagstromerBiasEffectiveBidask2021]], p. 317)

**reasons why we use the midpoint:** “The appeal of the midpoint is arguably data availability and simplicity. Data on the best bid and ask prices are publicly available for many asset classes and market types (both auction and dealer markets) and in long time series. In markets where the quotes are valid until canceled, such as limit order book markets, midpoint observations are available continuously during trading hours. Furthermore, the midpoint is straightforward to compute in real time, and is easy to understand for all market participants.” ([[@hagstromerBiasEffectiveBidask2021]], p. 317)

**Definition:** "We also define the effective spread, a commonly used proxy for transaction costs. Recall that $m_t$ is the midpoint of the bid and ask quotes.

Definition 2: The true transaction cost faced by a market order of size $\bar{x}$ at time tis
$$
C_t(\bar{x})=\left(P_t(\bar{x})-v_t\right) \operatorname{sign}(\bar{x}) .
$$
The effective spread, $S_t(\bar{x})$, faced by a market order of size $\bar{x}$ at time $t$ is
$$
S_t(\bar{x})=\left(P_t(\bar{x})-m_t\right) \operatorname{sign}(\bar{x}) .
$$
The true transaction cost is necessarily unobservable in real data. In many econometric specifications (see Hasbrouck (2002) for a summary), the execution price is decomposed into the sum of the "efficient price" and microstructure effects. In our model, the efficient price is just the consensus value, $v_t$. Thus, our transaction cost $C_t$ is simply the microstructure effect times the signed order flow. Our sellers pay a cost if the transaction price is greater than the consensus value and receive a discount if it is below. Consider a trade that occurs at time $t$. The consumer surplus that accrues to the market order and limit order submitters is a measure of the net change in their welfare. ${ }^{25}$ Recall that $\bar{x}>0$ indicates a market buy order, and $\bar{x}<0$ a market sell order." (from [[@goettlerEquilibriumDynamicLimit2005]] 2173)