Tags: #trade-classification #lee-ready 

Accuracy has been tested in [[@odders-whiteOccurrenceConsequencesInaccurate2000]], [[@finucaneDirectTestMethods2000]] and [[@leeInferringInvestorBehavior2000]] on TORQ data set which contains the true label. (see [[@bessembinderIssuesAssessingTrade2003]])

**Algorithm:** See [[@leeInferringTradeDirection1991]]
**Algorithm:** Use a combination of quote and tick rule. Use tick rule to classify trades at midpoint and use the quote rule elsewhere.
![[lr-algo.png]]

Precise description from [[@carrionTradeSigningFast2020]] (Similar efforts in [[@jurkatisInferringTradeDirections2022]] or [[@olbrysEvaluatingTradeSide2018]]): 
The tick rule (TICK) relies solely on trade prices for classifying trades and does not use any quote data. To classify trades, the tick rule compares the current trade price to the price of the preceding trade. A trade is classified as a buy if the trade price is higher than the preceding trade price (uptick). Likewise, a trade is classified as a sell if the trade price is lower than the preceding trade price (downtick). If the preceding trade price is the same, then the tick rule looks back to the last different price to classify the trade. Likewise, a trade is classified as a sell if it occurs on a zero-downtick. Formally denoting the trade price of security $i$ at time $t$ as $P_{i, t}$ and $\Delta P_{i, t}$ as the price change between two successive trades and the assigned trade direction at time $t$ as Trade, we have:
If $\Delta P_{i, t}>0$, Trade $_{i, t}=$ Buy,
If $\Delta P_{i, t}<0$, Trade $_{i, t}=$ Sell,
If $\Delta P_{i, t}=0$, Trade $_{i, t}=$ Trade $_{i, t-1}$.
The LR algorithm is based on a combination of the tick rule and the quote rule. Using the quote rule, a trade is classified as a buy if the price is above the midpoint of the quoted bid and ask and as a sell if the price is below the midpoint. Denoting the midpoint of the quoted spread by $m_{i, t}$, the predicted trade direction as per the quote rule is as follows:
$$
\begin{aligned}
& \text { If } P_{i, t}>m_{i, t}, \text { Trade }_{i, t}=\text { Buy, } \\
& \text { If } P_{i, t}<m_{i, t} \text { Trade }_{i, t}=\text { Sell. }
\end{aligned}
$$

**Wordy explanation:**
‚Äú1. Trades occurring in the lower half of the spread, at the bid or below, are classified as sells. A similar scheme is used for trades in the upper half of the spread and these are classified as buys. Trades occurring below the bid or above the ask are classified similarly. 2. Trades occurring at the midpoint of the spread are first classified using the "tick test" applied to the previous trade. If the current trade price occurs at a price higher than the previous one, it is classified as a buy (trade on an uptick). A trade on a downtick is classified as a sell. Trades unclassifiable using the previous trade are classified using the "zerouptick" or the "zero-downtick" test, which identifies the last price change and then uses the tick test strategy.2‚Äù ([[@easleyOptionVolumeStock1998]], p. 453)
‚ÄúThe LR algorithm compares the transaction price to the mid-point of the ask and bid quote at the time the trade took place. If the transaction price is greater (smaller) than the mid-point, the trade is buyer-(seller-)initiated. If the transaction price is equal to the mid-point, the trade initiator is assigned according to the tick-test: if the transaction price is greater (smaller) than the last price that is not equal to the current transaction price, the trade is buyer-(seller-)initiated.‚Äù ([[@jurkatisInferringTradeDirections2022]]], 2022, p. 7)

**Impact:** ‚ÄúThe paper further shows that, while the Lee and Ready (1991) algorithm has been the default choice among the traditional trade classification algorithm‚Äîpossibly partly due to being automatically supplied by data vendors, partly due to its simplicity‚Äîthe similar simplistic algorithms of Chakrabarty et al. (2007) and Ellis et al. (2000) tend to perform better and may be preferred in certain applications.‚Äù (Jurkatis, 2022, p. 23)
**Impact:** According to [[@bessembinderIssuesAssessingTrade2003]] the most widley used algorithm to categorize trades as buyer or seller-initiated.

**Variations:** Reverse LR algorithm, first introduced in [[@grauerOptionTradeClassification2022]] (p 12). Combines the quote and reverse tick rule. Performs relatively well for options as shown in [[@grauerOptionTradeClassification2022]].

**Results:** See [[@carrionTradeSigningFast2020]] for comparisons in the stock market at different frequencies. The higher the frequency, the better the performance of LR. Similar paper for stock market [[@easleyFlowToxicityLiquidity2012]].
**Results:** üí∏ ‚ÄúThe degree of success varies inversely with a rule‚Äôs reliance on past transaction prices: 82.78% for the quote rule, 80.11% for LR, 76.54% for EMO, and 59.4% for the tick method.‚Äù (Savickas and Wilson, 2003, p. 886)
**Results:** üí∏ ‚ÄúEllis, Michaely, and O‚ÄôHara (2000) show that for Nasdaq trades, the quote, the tick, and the LR rules classify correctly 76.4%, 77.66%, and 81.05% of all trades, respectively. Also, the quote rule performs better with the options data than with Nasdaq data; the reverse is true for the tick and LR approaches.‚Äù (Savickas and Wilson, 2003, p. 887)
**Results:** üí∏ ‚ÄúSpecifically, the only difference between the tick and the EMO rules is that the latter uses the quote rule for at-the-quote trades. Consequently, the EMO method outperforms the tick rule only for those trades. Similarly, the LR and EMO methods treat at-the-quote and at-midspread trades exactly the same, but the LR approach applies the quote rule to all other trades.‚Äù (Savickas and Wilson, 2003, p. 891)
**Results:** üí∏ ‚ÄúSimilarly, the LR and EMO methods treat at-the-quote and at-midspread trades exactly the same, but the LR approach applies the quote rule to all other trades. As a result, the LR rule exhibits better performance than the EMO method only for trades that do not occur at quotes or midspread. Thus, there seems to be a direct relation between using the quote information and successful option trade classification. This relation implies that the information conveyed by the past transaction prices is less relevant than information contained in quotes. Thus, there seems to be a direct relation between using the quote information and successful option trade classification. This relation implies that the information conveyed by the past transaction prices is less relevant than information contained in quotes.‚Äù (Savickas and Wilson, 2003, p. 891)
**Results:** üí∏ ‚ÄúIn particular, the prevailing Lee and Ready algorithm is only able to correctly sign between 60% to 64% of option trades, which is a similar magnitude as using the quote rule alone.‚Äù (Grauer et al., 2022, p. 0)
**Results:** üí∏ ‚ÄúStandard LR algorithms, for which tick rules are based on the preceding trade, are always worse than their ‚Äúreverse‚Äú counterparts for which tick rules are based on the succeeding trade. The EMO rule is inferior to the LR algorithm, as it uses the tick rule to a greater extend. Using tick rules alone is always the worst choice.‚Äù (Grauer et al., 2022, p. 21)
**Results:** üí∏ Applied to CBOE data set see [[@easleyOptionVolumeStock1998]] but no accuracies reported, as they might not have the ground thruth.

**Effective spread:** ‚ÄúThe quote and the tick rules are the two extremes. The LR and EMO methods take their respective places on the continuum between the quote and the tick rules. The EMO approach uses the quote rule to a lesser extent than does the LR algorithm; therefore, the EMO method exhibits a lower degree of spread overestimation than does the LR method.‚Äù ([[@savickasInferringDirectionOption2003]], 2003, p. 897)
**Effective spread:** ‚ÄúThe tick rule severely underestimates effective spread due to its low classification success. The LR and EMO methods take their respective places on the continuum between the quote and the tick rules.‚Äù ([[@savickasInferringDirectionOption2003]], 2003, p. 901)

**Limitations:** üë©‚Äçüöí ‚ÄúThe established methods, most notably the algorithms of Lee and Ready (1991) (LR), Ellis et al. (2000) (EMO), and Chakrabarty et al. (2007) (CLNV), classify trades based on the proximity of the transaction price to the quotes in effect at the time of the trade. This is problematic due to the increased frequency of order submission and cancellation. With several quote changes taking place at the time of the trade, it is not clear which quotes to select for the decision rule of the algorithm.‚Äù (Jurkatis, 2022, p. 6)
**Limitations:** üë©‚Äçüöí ‚ÄúIf the second trade of the day takes place at the same price as the first one, both trades cannot be classified by the tick rule. The LR and EMO rules also lose some trades since they are combinations of the tick and the quote rules.‚Äù (Savickas and Wilson, 2003, p. 886) -> Wouldn't this be filled by the prev. trade that is different, even if it is from long ago?
**Limitations:** üë©‚Äçüöí Lee & Ready algorithm is less data efficient, as it requires both price and quote data. (see [[@odders-whiteOccurrenceConsequencesInaccurate2000]])
**Limitations:** üë©‚Äçüöí LR can not handle the simultanous arrival of market buy and sell orders. Thus, one side will always be wrongly classified. Equally, crossed limit orders are not handled correctly as both sides iniate a trade independent of each other (see [[@finucaneDirectTestMethods2000]]). 
**Limitations:** üë©‚Äçüöí ‚ÄúIf the second trade of the day takes place at the same price as the first one, both trades cannot be classified by the tick rule. The LR and EMO rules also lose some trades since they are combinations of the tick and the quote rules.‚Äù ([[@savickasInferringDirectionOption2003]], 2003, p. 886) -> really correct? Wouldn't we just take the previous trade price?
**Limitations:** üë©‚Äçüöí ‚ÄúHowever, recent literature suggests that with the advent of high frequency trading in markets, the accuracy of LR algorithm is potentially undermined. For example, Easley, Lopez de Prado and O‚ÄôHara (2016) argue that in electronic limit order markets, some with order cancellation rates of 98% or more, trade classification algorithms based on proximity to bid and ask quotes are severely compromised. Holden and Jacobsen (2014) using the TAQ data, and Panayides, Shohfi, and Smith (2014) employing Euronext Paris data provide empirical support for these claims. Furthermore, as Holden, Jacobsen, and Subrahmanyam (2015) observe, the trading environment in many financial markets (such as futures and foreign exchange trading) lacks transparency, in the sense actual quotes are not directly observable in the intra-daily data record.‚Äù ([[@boweNewClassicalBayesian]], 2018, p. 2)(do not cite bowe paper; poor quality)

‚ÄúFurther, when we isolate fast-paced quote and trade activity (a proxy for low-latency traders), LR performs poorly. In particular, when a given trade is executed in the same second as other trades, it is more than 9% less likely to be classified correctly. When a trade is associated with multiple quotes in the same second, it is 17% less likely‚Äù ([[@panayidesComparingTradeFlow2014]]) 

We can classify true trade initiators for 94% of our trade volume. This is a much larger percentage than older studies measuring the Lee-Ready and tick test performance (e.g., Odders-White (2000) classifies 74.9% of trades). Our sample‚Äôs true trade initiation percentage is comparable to contemporaneous work (see, for example, Chakrabarty et al. (2012)); it has the added advantage of low fragmentation to be correctly classified. With multiple trades and quotes in a single second, the accuracy rate drops nearly 21% vis-√†-vis those seconds with only one trade and quote.‚Äù ([[@panayidesComparingTradeFlow2014]], 2014, p. 3)

**Timing offsets:** ‚åö
- Also five second delay isn't universal and not even stated so in the paper. See the following comment from [[@rosenthalModelingTradeDirection2012]]
> Many studies note that trades are published with non-ignorable delays. Lee and Ready (1991) first suggested a five-second delay (now commonly used) for 1988 data, two seconds for 1987 data, and ‚Äúa different delay . . . for other time periods‚Äù. Ellis et al. (2000) note (Section IV.C) that quotes are updated almost immediately while trades are published with delay2. Therefore, determining the quote prevailing at trade time requires finding quotes preceding the trade by some (unknown) delay. Important sources of this delay include time to notify traders of their executions, time to update quotes, and time to publish the executions. For example, an aggressive buy order may trade against sell orders and change the inventory (and quotes) available at one or more prices. Notice is then sent to the buyer and sellers; quotes are updated; and, the trade is made public. This final publishing timestamp is what researchers see in nonproprietary transaction databases. Erlang‚Äôs (1909) study of information delays forms the theory for modeling delays. Bessembinder (2003) and Vergote (2005) are probably the best prior studies on delays between trades and quotes.
- For short discussion timing offset in CBOE data see [[@easleyOptionVolumeStock1998]] . For reasoning behind offset (e. g., why it makes senses / is necessary) see [[@bessembinderIssuesAssessingTrade2003]], who study the offset for the NASDAQ. Their conclusion is, that there is no universal optimal offset.
- in the original paper the offset between transaction prices and quotes is set to 5 sec [[@leeInferringTradeDirection1991]]. Subsequent research like [[@bessembinderIssuesAssessingTrade2003]] drop the adjustment. Researchers like [[@carrionTradeSigningFast2020]] perform robustness checks with different, subsequent delays in the robustness checks.
- ‚Äú0 Lee and Ready suggest a classification scheme wherein the quote prevailing 5 seconds before the transaction is used to classify the current trade, rather than the most recent quote. They argue that because of reporting protocols on the NYSE, the quote revision resulting from a current trade is likely to be recorded before the current trade, thereby biasing the trade classification. On the CBOE, however, the frequency of quote revisions is less than five seconds, and so using the most recent quote does not cause a bias in classification. The classification scheme we use captures the natural concept that buys tend to go at higher prices, and sales at lower prices. We caution, however, that trading and reporting protocols on the CBOE may introduce timing difficulties in the data, and to the extent that these are large, our classification scheme will be affected.‚Äù ([[@easleyOptionVolumeStock1998]], p. 453)
